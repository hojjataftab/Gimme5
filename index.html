<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gimme5 - New Year 2026 Raffle</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { 
            background-color: #0f0f0f; 
            color: white; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 20px;
            overflow-x: hidden;
        }

        /* Snow Animation */
        .snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .card { 
            background: linear-gradient(145deg, #1a1a1a, #222); 
            border-radius: 20px; 
            padding: 20px; 
            border: 1px solid #ffd700; 
            margin-bottom: 15px; 
            position: relative; 
            overflow: hidden; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .winner-card { border-color: #00ffcc; background: rgba(0, 255, 204, 0.05); }
        .prize-tag { background: #ffd700; color: black; position: absolute; top: 10px; right: -30px; transform: rotate(45deg); padding: 5px 40px; font-size: 0.6rem; font-weight: bold; }
        
        h1 { color: #ffd700; margin: 10px 0; font-size: 2.2rem; text-transform: uppercase; text-shadow: 0 0 15px rgba(255, 215, 0, 0.4); }
        .grand-prize-title { font-size: 0.9rem; color: #ffd700; letter-spacing: 2px; margin-bottom: 5px; font-weight: bold; opacity: 0.8; }
        .prize-amount { font-size: 3.8rem; font-weight: bold; color: #ffd700; text-shadow: 0 0 25px rgba(255, 215, 0, 0.5); margin: 5px 0; }
        
        .timer-container { display: flex; justify-content: center; gap: 8px; margin: 20px 0; }
        .timer-unit { background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 12px; padding: 8px; min-width: 55px; }
        .timer-val { display: block; font-size: 1.4rem; font-weight: bold; color: #ffd700; }
        .timer-label { font-size: 0.5rem; color: #aaa; text-transform: uppercase; }

        .btn-join { background: #0088cc; color: white; border: none; padding: 16px; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.3s; }
        .btn-invite { background: linear-gradient(45deg, #ffd700, #ffa500); color: black; border: none; padding: 18px; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 1.1rem; box-shadow: 0 5px 20px rgba(255, 165, 0, 0.3); }
        
        .ref-box { background: rgba(255, 255, 255, 0.03); border: 1px solid #333; padding: 15px; border-radius: 15px; margin-top: 20px; }
        .ref-status { background: #0088cc; color: white; padding: 12px; border-radius: 12px; font-size: 1rem; display: inline-block; margin-bottom: 10px; font-weight: bold; width: 90%; }
        
        .stats-info { font-size: 0.85rem; color: #00ffcc; margin-top: 15px; font-weight: bold; }

        @keyframes snowFall {
            0% { transform: translateY(-10vh); }
            100% { transform: translateY(100vh); }
        }
        .flake { position: absolute; color: white; opacity: 0.4; animation: snowFall linear infinite; }
    </style>
</head>
<body>

    <div class="snow-container" id="snow"></div>

    <div id="main-page">
        <div style="font-size: 0.75rem; color: #ffd700; margin-bottom: 15px; font-weight: bold; letter-spacing: 1px;">üéÑ NEW YEAR 2026 SPECIAL EVENT üéÑ</div>

        <div class="card winner-card">
            <h3 style="color: #00ffcc; margin: 0; font-size: 0.7rem; letter-spacing: 1px; opacity: 0.8;">PREVIOUS WINNER üèÜ</h3>
            <p style="font-size: 1.3rem; font-weight: bold; margin: 8px 0;">@Aftab_Ht</p>
        </div>

        <div class="card">
            <div class="prize-tag">FREE ENTRY</div>
            <div class="grand-prize-title">WINNER TAKES ALL</div>
            <h1>Gimme5</h1>
            <div class="prize-amount">100 <span style="font-size: 1.2rem; opacity: 0.7;">USDT</span></div>
            
            <div class="timer-container" id="raffle-timer">
                <div class="timer-unit"><span class="timer-val" id="days">00</span><span class="timer-label">Days</span></div>
                <div class="timer-unit"><span class="timer-val" id="hours">00</span><span class="timer-label">Hours</span></div>
                <div class="timer-unit"><span class="timer-val" id="mins">00</span><span class="timer-label">Mins</span></div>
                <div class="timer-unit"><span class="timer-val" id="secs">00</span><span class="timer-label">Secs</span></div>
            </div>

            <button class="btn-join" onclick="openChannel()">
                <span>üì¢</span> JOIN @gemmi5bot
            </button>
            <button class="btn-invite" onclick="copyRef()">INVITE 5 FRIENDS</button>
            
            <div class="stats-info">
                üî• <span id="participant-count">...</span> Members Joined
            </div>
        </div>

        <div class="ref-box">
            <div id="ref-status-label" class="ref-status">Checking your status...</div>
            <p style="font-size: 0.75rem; color: #888; margin-top:10px;">Your Invite Link:</p>
            <div id="my-ref-link" style="font-size: 0.7rem; color: #ffd700; margin: 8px 0; word-break: break-all; background: #000; padding: 12px; border-radius: 10px; border: 1px solid #444;">https://t.me/gimme5bot?start=...</div>
        </div>
    </div>

    <script>
        const tele = window.Telegram.WebApp;
        tele.ready();
        tele.expand();

        // üü¢ IMPORTANT: YOUR UPDATED SCRIPT URL
        const scriptURL = "https://script.google.com/macros/s/AKfycbzuoHqfgucv_Ty5ePOlt7akh1lIMc2zQs3aIMFyrkKWMxCKIrPB_U-BQ9n-IYaab3m--Q/exec"; 

        const user = tele.initDataUnsafe.user;
        const userId = user ? user.id : "00000";

        // Create Snow
        function createSnow() {
            const snowContainer = document.getElementById('snow');
            for (let i = 0; i < 25; i++) {
                let flake = document.createElement('div');
                flake.className = 'flake';
                flake.innerText = '‚ùÑ';
                flake.style.left = Math.random() * 100 + 'vw';
                flake.style.animationDuration = (Math.random() * 5 + 5) + 's';
                flake.style.fontSize = (Math.random() * 10 + 10) + 'px';
                flake.style.animationDelay = Math.random() * 5 + 's';
                snowContainer.appendChild(flake);
            }
        }
        createSnow();

        // Countdown Timer
        const raffleDate = new Date("January 1, 2026 00:00:00").getTime();
        function updateTimer() {
            const now = new Date().getTime();
            const distance = raffleDate - now;
            if (distance < 0) {
                document.getElementById("raffle-timer").innerHTML = "HAPPY NEW YEAR 2026! ü•Ç";
                return;
            }
            document.getElementById("days").innerText = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
            document.getElementById("hours").innerText = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
            document.getElementById("mins").innerText = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
            document.getElementById("secs").innerText = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // Sync with Google Sheet
        async function syncData() {
            document.getElementById('my-ref-link').innerText = `https://t.me/gimme5bot?start=${userId}`;
            try {
                const response = await fetch(`${scriptURL}?uId=${userId}`);
                const result = await response.json();
                
                // Update total members (Starting from 120 for social proof)
                document.getElementById('participant-count').innerText = 120 + result.totalParticipants;
                
                const count = result.refCount;
                const label = document.getElementById('ref-status-label');
                
                if(count >= 5) {
                    label.innerText = `‚úÖ QUALIFIED (${count}/5)`;
                    label.style.background = "#00ffcc";
                    label.style.color = "black";
                } else {
                    label.innerText = `üìä Progress: ${count} of 5 Invited`;
                    label.style.background = "#0088cc";
                }
            } catch (e) { 
                document.getElementById('ref-status-label').innerText = "Invite 5 friends to qualify!";
            }
        }
        syncData();

        function openChannel() {
            tele.openTelegramLink("https://t.me/gemmi5bot");
        }

        function copyRef() {
            const link = document.getElementById('my-ref-link').innerText;
            const el = document.createElement('textarea');
            el.value = link;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            tele.showAlert("Link Copied! üéÅ\nSend it to 5 friends to enter the $100 raffle!");
        }
    </script>
</body>
</html>
